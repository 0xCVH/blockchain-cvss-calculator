<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' cdn.jsdelivr.net; style-src 'self' cdn.jsdelivr.net; font-src 'self' cdn.jsdelivr.net">
  <title>GitLab CVSS Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <link href="css/application.css" rel="stylesheet">
  <meta name="theme-color" content="#9b51e0">
</head>

<body>
  <main class="container">
    <div id="app">
      <div class="bg-light p-5 rounded">
        <h1>GitLab CVSS Calculator</h1>
        <p class="lead">This calculator is used to calculate bounties for vulnerabilities reported to GitLab's <a href="https://hackerone.com/gitlab">Bug Bounty Program on HackerOne</a> or via our <a href="https://about.gitlab.com/security/disclosure/">Responsible Disclosure Policy</a>.
          Answering the questions will calculate a severity score using the Common Vulnerability Scoring System (<a href="https://www.first.org/cvss/v3.1/specification-document">CVSS</a>)
          which is used to calculate a suggested bug bounty based on the impact.</p>
      </div>

      <transition name="slide-fade" mode="out-in">
        <Question v-bind:question="current_question" :key="current_question.question"></Question>
      </transition>
      <SkipQuestions></SkipQuestions>

      <Definitions></Definitions>

      <div class="examples">
        <h3>Other Bounty Examples</h3>
        <p>The suggested bounty amounts for issues that aren't exploitable but we would like to reward regardless are defined below:
          <ul>
            <li>Self-XSS: $100</li>
          </ul>
        </p>
        <h4>Non-CVSS Bounties</h4>
        <p>For leakage of GitLab customer data or other PII, the suggested bounty amount would be as defined below. Note that each of these conditions presuppose that the data was leaked by GitLab and not the customer themselves:
          <ul>
            <li>Security-related documentation update: $100</li>
            <li>Leaked customer names: $500</li>
            <li>Leaked customer names, emails, financial data: $1,000</li>
            <li>Leaked customer tokens, keys or credentials allowing access to non-GitLab environments: $7,500-$35,000 depending on impact</li>
          </ul>
        </p>
        <p>For GitLab team member token disclosure, the suggested bounty amount would be as defined below. Note that to reach the "maintainer" level, the token needs to have maintainer access on gitlab-org/gitlab or an equivalent "production" project.
          <ul>
            <li>Leaked non-maintainer access token on staging.gitlab.com: $0 (no sensitive issues to read unlike on gitlab.com)</li>
            <li>Leaked token for a Developer+ direct member of a group or project under the gitlab-com or gitlab-org namespaces, without sensitive data: $1000</li>
            <li>Leaked non-maintainer access token on gitlab.com: $7,500</li>
            <li>Leaked maintainer access token on gitlab.com: $15,000</li>
            <li>Leaked admin access token on gitlab.com: $35,000</li>
            <li>Leaked product project maintainer or admin access token on staging.gitlab.com: $15,000 (no customer data, admin and maintainer have similar impact)</li>
          </ul>
        </p>
        <p>Reports about intended behavior resulting in an update of our documentation will be rewarded with a $100 bounty, as long as this update is security related.</p>
      </div>
    </div>
  </main>

  <script type="text/x-template" id="answer-template">
    <div class="col-sm-6">
      <div class="card answer text-center h-100 bg-light" v-on:click="answer.onSelect">
        <div class="card-body">
          <h5 class="card-title">{{ answer.answer }}</h5>
          <h6 class="card-subtitle mb-2 text-muted" v-if="answer.extra">{{ answer.extra }}</h6>
          <Examples v-if="answer.examples" v-bind:examples="answer.examples"></Examples>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="question-template">
    <div class="question">
      <h3 class="border-bottom text-muted fw-lighter">{{ question.title }}</h3>
      <h2>{{ question.question }}</h2>
      <p v-if="question.extra">{{ question.extra }}</p>
      <div class="answers">
        <div class="row">
          <QuestionAnswer
            v-bind:key="answer.answer"
            v-for="answer in question.answers"
            v-bind:answer="answer"
          ></QuestionAnswer>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="skip-questions-template">
    <div class="skip-questions">
      <a href="#" v-on:click="showForm" v-show="!formShown">Skip questions, I already have a CVSS vector.</a>
      <form v-show="formShown">
        <div class="input-group input-group-lg">
          <input type="text" class="form-control" v-model="cvssVector" placeholder="CVSS vector... e.g. CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H" aria-label="CVSS Vector" aria-describedby="button-submit-cvss-vector" required>
          <button class="btn btn-outline-primary" type="button" id="button-submit-cvss-vector" :disabled="!validCvssVector" v-on:click="showScore">Submit</button>
        </div>
      </form>
    </div>
  </script>

  <script type="text/x-template" id="score-card-template">
    <div class="col-sm">
      <div class="card score-card text-center text-white mb-3" ref="card" data-bs-toggle="popover"
        :class="{ 'bg-danger': severityHigh, 'bg-warning': severityMedium, 'bg-success': severityLow }">
        <div class="card-header">{{ metric }}</div>
        <div class="card-body">
          <h5 class="card-title">{{ humanFriendlyScore }}</h5>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="score-modal-template">
    <div class="modal modal-fade" tabindex="-1" id="score-modal" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <span v-if="oldCVSSVersion"><a title="CVSS3.0 is deprecated at GitLab">‚ö†Ô∏è</a>&nbsp;&nbsp;</span>
              {{cvssVector}} <span class="badge rounded-pill"
              :class="{ 'bg-danger': severityCritical || severityHigh, 'bg-warning': severityMedium, 'bg-success': severityLow }">{{ cvssScore }} ({{ severity }})</span></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <ScoreCard
                v-for="(score, metric) in cvssMetrics"
                v-bind:metric="metric"
                v-bind:score="score"
                v-bind:key="metric"></ScoreCard>
            </div>

            <div class="bounty text-center">
              <h2 class="display-6">üí∞ Suggested Bounty üí∞</h2>
              <h3 class="display-5">{{ suggestedBounty }}</h3>
            </div>

            <div class="bounty-range text-center">
              <p>Bounty Range:</p>
              <div class="btn-group">
                <a href="#" data-bounty-range="old" v-on:click="changeBountyRange" class="btn btn-outline-primary" :class="bountyRange == 'old' ? 'active' : ''">Pre Nov 22, 2021</a>
                <a href="#" data-bounty-range="new" v-on:click="changeBountyRange" class="btn btn-outline-primary" :class="bountyRange == 'new' ? 'active' : ''">Post Nov 22, 2021</a>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <p class="text-right text-muted" v-if="oldCVSSVersion">‚ö†Ô∏è&nbsp;&nbsp;CVSS3.0 is deprecated at GitLab. Use CVSS3.1.</p>
            <button type="button" class="btn btn-primary" v-on:click="copyMarkdownLinkToClipboard" ref="btnCopyMarkdownLink">Copy Markdown link</button>
            <button type="button" class="btn btn-primary" v-on:click="copyURLToClipboard" ref="btnCopyUrl">Copy URL</button>
            <button type="button" class="btn btn-primary" v-on:click="copyVectorToClipboard" ref="btnCopyVector">Copy vector</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="definitions-template">
    <div class="definitions">
      <a href="#" v-on:click="toggleDefinitions" v-show="!definitionsShown">Show help & definitions.</a>
      <a href="#" v-on:click="toggleDefinitions" v-show="definitionsShown">Hide help & definitions.</a>
      <div v-show="definitionsShown">
        <h3>Background</h3>
        <p>
          Accuracy and consistency of these scores is important. At any time when deciding on a score do not hesitate to ask for advice in the Bug Bounty Council issue or by reaching out to team members by any way you see fit. All CVSS & bounty amounts are <a href="https://about.gitlab.com/handbook/engineering/security/security-engineering-and-research/application-security/runbooks/hackerone-process.html#awards">peer reviewed</a> as described in <a href="https://about.gitlab.com/handbook/engineering/security/security-engineering-and-research/application-security/runbooks/hackerone-process.html">our HackerOne Process runbook</a>.
        </p>
        <p>
          CVSS is owned by FIRST and used by permission. This calculator is based on the <a href="https://www.first.org/cvss/user-guide">FIRST CVSS user guide</a>, especially the <a href="https://www.first.org/cvss/user-guide#Scoring-Rubrics">Scoring Rubrics section</a>. Remember, in particular, to "constrain impacts to a reasonable final impact which they are confident an attacker is able to achieve".
        </p>
        <p>Contribute to, fork, or view the history of this calculator at <a href="https://gitlab.com/gitlab-com/gl-security/appsec/cvss-calculator">https://gitlab.com/gitlab-com/gl-security/appsec/cvss-calculator</a>.</p>
        <h3>Metrics</h3>
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <td>Metric</td>
              <td>Definition</td>
              <td>Examples</td>
            </tr>
          </thead>
          <tbody>
            <tr class="example" v-for="definition in definitions">
              <td>
                <code>{{ definition.metric_value }}</code>
              </td>
              <td>
                {{ definition.extra }}
              </td>
              <td>
                <ul>
                  <li class="example" v-for="example in definition.examples">{{ example }}</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
  <script src="js/cvsscalc30.js"></script>
  <script src="js/cvsscalc31.js"></script>
  <script src="js/application.js"></script>
</body>

</html>
